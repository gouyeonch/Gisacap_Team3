<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8" %>

    <!DOCTYPE html>
    <html lang="en">

    <head>
        <meta charset="UTF-8">
        <title>양식 광어의 질병 감염 여부 판별 시스템</title>
        <link href="../..//resources/css/style.css" rel="stylesheet" />
        <style>
            #preview {
                width: 300px;
                height: 300px;
                border: 1px solid #ccc;
                display: flex;
                justify-content: center;
                align-items: center;
            }

            #preview img {
                max-width: 100%;
                max-height: 100%;
            }
        </style>
    </head>

    <body>
        <div id="farmInputView">
            <h2>양식장 뷰(입력)</h2>
            <form method="post" enctype="multipart/form-data">
                <div>
                    사진 업로드<br /><br />
                    <input type="file" id="fishImg" name="fishImg" accept="image/*" onchange="loadFile(this)" />
                    <div id="preview"></div>
                    <script>
                        // 기본 이미지 경로
                        var defaultImageSrc = "../..//resources/images/noImage.jpg";

                        // 미리보기 함수
                        function previewImage(imageSrc) {
                            var preview = document.getElementById('preview');
                            preview.innerHTML = '';

                            var image = new Image();
                            image.src = imageSrc;
                            image.onload = function () {
                                var maxWidth = preview.offsetWidth;
                                var maxHeight = preview.offsetHeight;
                                var width = image.width;
                                var height = image.height;

                                if (width > height) {
                                    if (width > maxWidth) {
                                        height *= maxWidth / width;
                                        width = maxWidth;
                                    }
                                } else {
                                    if (height > maxHeight) {
                                        width *= maxHeight / height;
                                        height = maxHeight;
                                    }
                                }

                                image.width = width;
                                image.height = height;
                                preview.appendChild(image);
                            };
                        }

                        // 파일 선택 시 미리보기
                        document.getElementById('fishImg').addEventListener('change', function (e) {
                            var file = e.target.files[0];
                            var reader = new FileReader();

                            reader.onload = function (e) {
                                previewImage(e.target.result);
                            };

                            reader.readAsDataURL(file);
                        });

                        // 페이지 로드 시 기본 이미지 미리보기
                        window.addEventListener('load', function () {
                            previewImage(defaultImageSrc);
                        });
                    </script>
                </div><br />
                <fieldset>
                    <legend> 해당되는 증상을 모두 선택하세요. </legend>
                    <p><input type="checkbox" name="symptom" value="s0"><label>무기력한 행동 및 거식</label></p>
                    <p><input type="checkbox" name="symptom" value="s1"><label>입올림(떠오름)</label></p>
                    <p><input type="checkbox" name="symptom" value="s2"><label>침하(가라앉음)</label></p>
                    <p><input type="checkbox" name="symptom" value="s3"><label>빙빙 도는 등의 이상 행동</label></p>
                    <p><input type="checkbox" name="symptom" value="s4"><label>지나치게 검은 체색</label></p>
                    <p><input type="checkbox" name="symptom" value="s5"><label>과다한 점액 분비(또는 그로 인한 체표의 백탁)</label></p>
                    <p><input type="checkbox" name="symptom" value="s6"><label>체표의 상처 또는 궤양</label></p>
                    <p><input type="checkbox" name="symptom" value="s7"><label>등뼈 근처의 출혈</label></p>
                    <p><input type="checkbox" name="symptom" value="s8"><label>백색의 반흔</label></p>
                    <p><input type="checkbox" name="symptom" value="s9"><label>복부 팽만</label></p>
                    <p><input type="checkbox" name="symptom" value="s10"><label>지느러미 결손</label></p>
                    <p><input type="checkbox" name="symptom" value="s11"><label>지느러미 충혈</label></p>
                    <p><input type="checkbox" name="symptom" value="s12"><label>지느러미 출혈</label></p>
                    <p><input type="checkbox" name="symptom" value="s13"><label>지느러미 가장자리의 백탁</label></p>
                    <p><input type="checkbox" name="symptom" value="s14"><label>머리의 충혈</label></p>
                    <p><input type="checkbox" name="symptom" value="s15"><label>안구의 백탁, 충혈, 돌출</label></p>
                    <p><input type="checkbox" name="symptom" value="s16"><label>안구 주변의 농양</label></p>
                    <p><input type="checkbox" name="symptom" value="s17"><label>아가미의 충혈</label></p>
                    <p><input type="checkbox" name="symptom" value="s18"><label>아가미의 괴사 및 출혈</label></p>
                    <p><input type="checkbox" name="symptom" value="s19"><label>턱에서의 충혈</label></p>
                    <p><input type="checkbox" name="symptom" value="s20"><label>항문의 확장과 출혈, 장의 돌출</label></p>
                    <p><input type="checkbox" name="symptom" value="s21"><label>종양</label></p>
                </fieldset>
                <input type="submit" />
            </form>
        </div>
        <hr />
        <div id="expertView">
            <h2>전문가 뷰</h2>
            <div>
                양식장 사진<br />
                <div id="preview"></div><br />
            </div><br />
            <div>
                <h3>ChatGPT의 의견</h3>
                예상되는 병명<br />
                <p id="gptDiseaseName" class="diseaseName"></p>
                예방책 및 해결 방안<br />
                <p id="gptDiseaseSolution" class="diseaseSolution"></p>
            </div><br />
            <h3>의견 전송</h3>
            **ChatGPT가 제시한 의견에는 오류가 있을 수 있습니다.**<br />
            **ChatGPT의 의견을 수정, 혹은 보완하여 제출해 주세요.**<br /><br />
            <form method="post">
                <fieldset>
                    <legend>예상되는 병명을 모두 선택하세요.</legend>
                    <p><input type="checkbox" name="expertDiseasName" value="d0"><label>병에 걸리지 않음</label></p>
                    <p><input type="checkbox" name="expertDiseasName" value="d1"><label>렙도바이러스병</label></p>
                    <p><input type="checkbox" name="expertDiseasName" value="d2"><label>림포시스티스병</label></p>
                    <p><input type="checkbox" name="expertDiseasName" value="d3"><label>바이러스성신경괴사증</label></p>
                    <p><input type="checkbox" name="expertDiseasName" value="d4"><label>버나바이러스병</label></p>
                    <p><input type="checkbox" name="expertDiseasName" value="d5"><label>헐피스 바이러스증</label></p>
                    <p><input type="checkbox" name="expertDiseasName" value="d6"><label>비브리오병</label></p>
                    <p><input type="checkbox" name="expertDiseasName" value="d7"><label>연쇄구균증</label></p>
                    <p><input type="checkbox" name="expertDiseasName" value="d8"><label>에드워드병</label></p>
                    <p><input type="checkbox" name="expertDiseasName" value="d9"><label>활주세균증</label></p>
                    <p><input type="checkbox" name="expertDiseasName" value="d10"><label>백점충증</label></p>
                    <p><input type="checkbox" name="expertDiseasName" value="d11"><label>스쿠티카증</label></p>
                    <p><input type="checkbox" name="expertDiseasName" value="d12"><label>트리코디나증</label></p>
                </fieldset>


                예방책 및 해결 방안<br /><textarea id="expertDiseaseSolution" name="expertDiseaseSolution" cols="50" rows="10"
                    maxlength="2000"></textarea><br />
                <input type="submit" />
            </form>
        </div>
        <hr />
        <div id="farmOutputView">
            <h2>양식장 뷰(출력)</h2>
            <img class="uploadedImg" src="../..//resources/images/noImage.jpg" /><br />
            **ChatGPT가 제시한 의견에는 오류가 있을 수 있습니다.**<br /><br />
            작성자<br />
            <p id="author"></p>
            예상되는 병명<br />
            <p id="diseaseName" class="diseaseName"></p>
            예방책 및 해결 방안<br />
            <p id="diseaseSolution" class="diseaseSolution"></p>
        </div>
    </body>

    </html>